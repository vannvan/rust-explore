# ðŸ—„ï¸ æœ¬åœ°åŒ–ç¼“å­˜åŠŸèƒ½è¯´æ˜Ž

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

`yuque-tools-gui` é¡¹ç›®å·²å®žçŽ°å®Œæ•´çš„æœ¬åœ°åŒ–ç¼“å­˜åŠŸèƒ½ï¼Œå‚è€ƒäº† `yuque-tools` é¡¹ç›®çš„ç¼“å­˜ç­–ç•¥ã€‚ç¼“å­˜åŠŸèƒ½å¯ä»¥æ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒï¼Œå‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚ã€‚

## ðŸŽ¯ ç¼“å­˜å†…å®¹

### 1. **ç”¨æˆ·ä¿¡æ¯ç¼“å­˜** (`user_info.json`)

- **å†…å®¹**ï¼šç”¨æˆ· IDã€ç™»å½•åã€æ˜µç§°ã€å¤´åƒã€æè¿°
- **æ—¶æ•ˆ**ï¼š30 åˆ†é’Ÿ
- **è§¦å‘**ï¼šç™»å½•æˆåŠŸåŽè‡ªåŠ¨ä¿å­˜

### 2. **ä¼šè¯ Cookies ç¼“å­˜** (`cookies.json`)

- **å†…å®¹**ï¼šå®Œæ•´çš„è¯­é›€ä¼šè¯ cookies
- **æ—¶æ•ˆ**ï¼š30 åˆ†é’Ÿ
- **è§¦å‘**ï¼šç™»å½•æˆåŠŸåŽè‡ªåŠ¨ä¿å­˜

### 3. **çŸ¥è¯†åº“ä¿¡æ¯ç¼“å­˜** (`books_info.json`)

- **å†…å®¹**ï¼šä¸ªäººçŸ¥è¯†åº“ + å›¢é˜ŸçŸ¥è¯†åº“ + æ–‡æ¡£ç»“æž„
- **æ—¶æ•ˆ**ï¼š30 åˆ†é’Ÿ
- **è§¦å‘**ï¼šé¦–æ¬¡èŽ·å–çŸ¥è¯†åº“åŽè‡ªåŠ¨ä¿å­˜

## ðŸ“ ç¼“å­˜å­˜å‚¨ä½ç½®

```
~/.config/yuque-tools-gui/.meta/
â”œâ”€â”€ user_info.json      # ç”¨æˆ·ä¿¡æ¯ç¼“å­˜
â”œâ”€â”€ cookies.json        # ä¼šè¯ Cookies
â””â”€â”€ books_info.json     # çŸ¥è¯†åº“ä¿¡æ¯ç¼“å­˜
```

## ðŸ”„ ç¼“å­˜å·¥ä½œæµç¨‹

### **åº”ç”¨å¯åŠ¨æ—¶**

1. `YuqueService::new()` è‡ªåŠ¨è°ƒç”¨ `load_from_cache()`
2. æ£€æŸ¥ç¼“å­˜æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ
3. åŠ è½½æœ‰æ•ˆçš„ç”¨æˆ·ä¿¡æ¯å’Œ Cookies
4. æ¢å¤ç™»å½•çŠ¶æ€

### **ç™»å½•æˆåŠŸåŽ**

1. è‡ªåŠ¨ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°ç¼“å­˜
2. è‡ªåŠ¨ä¿å­˜ Cookies åˆ°ç¼“å­˜
3. è®¾ç½® 30 åˆ†é’Ÿè¿‡æœŸæ—¶é—´

### **èŽ·å–çŸ¥è¯†åº“æ—¶**

1. é¦–å…ˆæ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ
2. **æœ‰æ•ˆç¼“å­˜**ï¼šç›´æŽ¥è¿”å›žç¼“å­˜æ•°æ®ï¼ˆå¿«é€Ÿå“åº”ï¼‰
3. **æ— ç¼“å­˜/è¿‡æœŸ**ï¼šè¯·æ±‚è¯­é›€ API â†’ ä¿å­˜æ–°æ•°æ®åˆ°ç¼“å­˜

### **ç”¨æˆ·ç™»å‡ºæ—¶**

1. è‡ªåŠ¨æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ–‡ä»¶
2. é‡ç½®åº”ç”¨çŠ¶æ€

## âš¡ æ€§èƒ½ä¼˜åŒ–æ•ˆæžœ

### **é¿å…é‡å¤è¯·æ±‚**

- âœ… 30 åˆ†é’Ÿå†…é‡å¤è®¿é—®ç›´æŽ¥ä½¿ç”¨ç¼“å­˜
- âœ… åº”ç”¨é‡å¯åŽä»ä¿æŒç™»å½•çŠ¶æ€
- âœ… çŸ¥è¯†åº“åˆ—è¡¨å¿«é€ŸåŠ è½½

### **ç”¨æˆ·ä½“éªŒæå‡**

- âœ… ç™»å½•çŠ¶æ€æŒä¹…åŒ–
- âœ… é¡µé¢åˆ‡æ¢æ— éœ€é‡æ–°åŠ è½½æ•°æ®
- âœ… ç½‘ç»œæ–­å¼€æ—¶ä»å¯æŸ¥çœ‹å·²ç¼“å­˜çš„æ•°æ®

## ðŸ§ª æµ‹è¯•ç¼“å­˜åŠŸèƒ½

### **è¿è¡Œæµ‹è¯•è„šæœ¬**

```bash
node test-cache.js
```

### **æ‰‹åŠ¨æ£€æŸ¥ç¼“å­˜**

```bash
# æŸ¥çœ‹ç¼“å­˜ç›®å½•
ls -la ~/.config/yuque-tools-gui/.meta/

# æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ç¼“å­˜
cat ~/.config/yuque-tools-gui/.meta/user_info.json

# æŸ¥çœ‹çŸ¥è¯†åº“ç¼“å­˜
cat ~/.config/yuque-tools-gui/.meta/books_info.json
```

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### **åŽç«¯ (Rust)**

- **CacheManager**ï¼šç®¡ç†æ‰€æœ‰ç¼“å­˜æ“ä½œ
- **å¯åŠ¨åŠ è½½**ï¼š`load_from_cache()` è‡ªåŠ¨æ¢å¤çŠ¶æ€
- **å¼‚æ­¥å‹å¥½**ï¼šClone æ¨¡å¼é¿å…é”ç«žäº‰
- **é”™è¯¯å¤„ç†**ï¼šä¼˜é›…çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### **ç¼“å­˜æ–‡ä»¶æ ¼å¼**

æ‰€æœ‰ç¼“å­˜æ–‡ä»¶éƒ½ä½¿ç”¨ JSON æ ¼å¼ï¼ŒåŒ…å«ï¼š

- `expire_time`ï¼šè¿‡æœŸæ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰
- å…·ä½“æ•°æ®å†…å®¹

### **è¿‡æœŸæ£€æŸ¥æœºåˆ¶**

```rust
fn is_cache_expired(expire_time: u128) -> bool {
    expire_time < Self::gen_timestamp()
}
```

## ðŸ“Š ç¼“å­˜ç»Ÿè®¡

### **ç¼“å­˜çŠ¶æ€æ£€æŸ¥**

- ç¼“å­˜æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- ç¼“å­˜æ˜¯å¦è¿‡æœŸ
- ç¼“å­˜å†…å®¹ç»Ÿè®¡

### **ç¼“å­˜æ¸…ç†**

- æ‰‹åŠ¨æ¸…ç†æ‰€æœ‰ç¼“å­˜
- æ¸…ç†è¿‡æœŸç¼“å­˜
- æ¸…ç†ç”¨æˆ·ç›¸å…³ç¼“å­˜

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### **é¦–æ¬¡ä½¿ç”¨**

1. å¯åŠ¨åº”ç”¨
2. è¾“å…¥è¯­é›€è´¦å·å¯†ç ç™»å½•
3. ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºç¼“å­˜ç›®å½•å’Œæ–‡ä»¶

### **æ—¥å¸¸ä½¿ç”¨**

1. åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ç¼“å­˜
2. è®¿é—®çŸ¥è¯†åº“æ—¶ä¼˜å…ˆä½¿ç”¨ç¼“å­˜
3. ç¼“å­˜è¿‡æœŸæ—¶è‡ªåŠ¨æ›´æ–°

### **æ•…éšœæŽ’é™¤**

1. å¦‚æžœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ é™¤ç¼“å­˜ç›®å½•
2. é‡æ–°ç™»å½•ä¼šé‡æ–°åˆ›å»ºç¼“å­˜
3. æ£€æŸ¥ç¼“å­˜æ–‡ä»¶æƒé™å’Œç£ç›˜ç©ºé—´

## ðŸ”’ å®‰å…¨è€ƒè™‘

### **æ•°æ®ä¿æŠ¤**

- ç¼“å­˜æ–‡ä»¶å­˜å‚¨åœ¨ç”¨æˆ·é…ç½®ç›®å½•
- éµå¾ªç³»ç»Ÿæƒé™è®¾ç½®
- ä¸åŒ…å«æ•æ„Ÿå¯†ç ä¿¡æ¯

### **éšç§ä¿æŠ¤**

- åªç¼“å­˜å¿…è¦çš„ä¸šåŠ¡æ•°æ®
- ç”¨æˆ·ç™»å‡ºæ—¶è‡ªåŠ¨æ¸…é™¤
- æ”¯æŒæ‰‹åŠ¨æ¸…ç†ç¼“å­˜

## ðŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### **ç¼“å­˜å‘½ä¸­çŽ‡**

- é¦–æ¬¡è®¿é—®ï¼š0%ï¼ˆéœ€è¦è¯·æ±‚ APIï¼‰
- 30 åˆ†é’Ÿå†…é‡å¤è®¿é—®ï¼š100%ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
- åº”ç”¨é‡å¯åŽï¼š100%ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰

### **å“åº”æ—¶é—´**

- ä½¿ç”¨ç¼“å­˜ï¼š< 10ms
- è¯·æ±‚ APIï¼š100-1000msï¼ˆå–å†³äºŽç½‘ç»œï¼‰

### **ç½‘ç»œè¯·æ±‚å‡å°‘**

- ç™»å½•çŠ¶æ€æ£€æŸ¥ï¼šå‡å°‘ 100%
- çŸ¥è¯†åº“åˆ—è¡¨èŽ·å–ï¼šå‡å°‘ 90%+
- ç”¨æˆ·ä¿¡æ¯èŽ·å–ï¼šå‡å°‘ 100%

## ðŸŽ‰ æ€»ç»“

æœ¬åœ°åŒ–ç¼“å­˜åŠŸèƒ½ä¸º `yuque-tools-gui` é¡¹ç›®å¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½æå‡å’Œç”¨æˆ·ä½“éªŒæ”¹å–„ã€‚é€šè¿‡æ™ºèƒ½çš„ç¼“å­˜ç­–ç•¥ï¼Œç”¨æˆ·å¯ä»¥äº«å—å¿«é€Ÿå“åº”çš„ç•Œé¢ï¼ŒåŒæ—¶ç¡®ä¿æ•°æ®çš„æ—¶æ•ˆæ€§ã€‚

ç¼“å­˜åŠŸèƒ½å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç®¡ç†ï¼Œç³»ç»Ÿä¼šæ ¹æ®éœ€è¦è‡ªåŠ¨åˆ›å»ºã€æ›´æ–°å’Œæ¸…ç†ç¼“å­˜æ–‡ä»¶ã€‚
